Configuring IS-IS to support **multi-area networks** involves deploying **Level 1 and Level 2 routers** to separate routing domains into different areas, enabling hierarchical routing like OSPF areas. Here’s how it works and how to configure it:

---

## Concept Recap: IS-IS Multi-Area Support

- **Level 1 routers**: Operate within a single area; they only know routes inside their own area.
    
- **Level 2 routers**: Operate as backbone routers connecting multiple areas; they know routes between areas.
    
- **Level 1-2 routers**: Act as area border routers (ABRs), connecting Level 1 areas to the Level 2 backbone.
    

---

## Steps to Configure IS-IS for Multi-Area Routing

### 1. **Define the NETs (Network Entity Titles) properly**

- The **NET** includes an **Area ID** portion. Different areas have different Area IDs.
    
- For example:
    
    - Area 1: NET = `49.0001.0100.0000.0001.00` (Area ID: `0001`)
        
    - Area 2: NET = `49.0001.0200.0000.0001.00` (Area ID: `0002`)
        

Each router’s NET must reflect the area it belongs to.

---

### 2. **Configure routers as Level 1, Level 2, or Level 1-2**

- **Level 1 routers** only exchange routes within their area.
    
- **Level 2 routers** form the backbone and exchange routes between areas.
    
- **Level 1-2 routers** connect areas to the backbone.
    

---

### 3. **Assign IS-IS levels on each router**

- In Cisco IOS:
    

```bash
router isis 1
 net 49.0001.<area-id>.<sys-id>.00
 is-type level-1         ! For routers inside an area only
! OR
 is-type level-2         ! For backbone routers
! OR
 is-type level-1-2       ! For area border routers
```

- Juniper example:
    

```bash
set protocols isis interface ge-0/0/0 level 1
set protocols isis interface ge-0/0/1 level 2
```

---

### 4. **Enable IS-IS on interfaces**

- Activate IS-IS and assign appropriate levels on each interface.
    

---

### 5. **Verify adjacency and routing**

- Level 1 routers form adjacencies only with other Level 1 routers in the same area.
    
- Level 2 routers form adjacencies with other Level 2 routers (backbone).
    
- Level 1-2 routers form adjacencies with both Level 1 and Level 2 neighbors.
    

---

## Example: Cisco IOS Configuration for Multi-Area IS-IS

```bash
! Router in Area 1 as Level 1 only
router isis 1
 net 49.0001.0100.0000.0001.00
 is-type level-1

interface GigabitEthernet0/0
 ip router isis 1
 isis network point-to-point

! Router in Area 2 as Level 1 only
router isis 1
 net 49.0001.0200.0000.0002.00
 is-type level-1

interface GigabitEthernet0/0
 ip router isis 1
 isis network point-to-point

! Router connecting Area 1 and Area 2 (ABR) as Level 1-2
router isis 1
 net 49.0001.0100.0000.0003.00
 is-type level-1-2

interface GigabitEthernet0/0  ! Connected to Area 1
 ip router isis 1
 isis network point-to-point

interface GigabitEthernet0/1  ! Connected to Area 2
 ip router isis 1
 isis network point-to-point

! Router acting as Level 2 backbone router
router isis 1
 net 49.0001.0000.0000.0004.00
 is-type level-2

interface GigabitEthernet0/0
 ip router isis 1
 isis network point-to-point
```

---

## Important Points

- Level 1 routers do not learn routes outside their area.
    
- Level 2 routers exchange routes between areas (backbone).
    
- Level 1-2 routers maintain routes for both their area and the backbone, effectively acting as **area border routers**.
    
- The **Area ID** is derived from the first part of the NET; changing the Area ID places the router in a different area.
    
- IS-IS **does not require explicit area configuration on interfaces**, levels are assigned per router or per interface.
    
- Level 2 routing forms a flat backbone similar to OSPF backbone area 0.
    
- Multi-area IS-IS allows scalable hierarchical routing by dividing large networks into manageable areas.
    

---

If you want, I can help with sample multi-area IS-IS configurations for specific router vendors or explain how route leaking between areas works in IS-IS. Would you like that?



----
---
---
---
Configuring IS-IS (Intermediate System to Intermediate System) to support **multi-area networks** involves setting up a hierarchical routing structure with multiple Level 1 areas connected through a Level 2 backbone. This setup leverages IS-IS’s two-level hierarchy (Level 1 for intra-area routing and Level 2 for inter-area routing) to ensure scalability and efficient routing across different areas. The configuration requires careful planning of Network Entity Titles (NETs), router types (Level 1, Level 2, or Level 1-2), and route leaking (if needed) to optimize inter-area routing. Below is a step-by-step guide for configuring IS-IS for multi-area networks on a **Cisco router**, as it’s a widely used platform, followed by notes for **Juniper** and general best practices. If you need configurations for another vendor (e.g., Nokia) or a specific scenario, let me know!

---

### Scenario Assumptions
- **Topology**:
  - **Area 49.0001**: Contains Router R1 (Level 1) and Router R2 (Level 1-2).
  - **Area 49.0002**: Contains Router R3 (Level 1) and Router R4 (Level 1-2).
  - **Level 2 Backbone**: Connects R2 and R4 for inter-area routing.
- **Interfaces**:
  - R1 (Area 49.0001): Loopback0 (1.1.1.1/32), GigabitEthernet0/0 (192.168.12.1/24, connected to R2).
  - R2 (Area 49.0001, L1-2): Loopback0 (2.2.2.2/32), GigabitEthernet0/0 (192.168.12.2/24, to R1), GigabitEthernet0/1 (192.168.24.1/24, to R4).
  - R3 (Area 49.0002): Loopback0 (3.3.3.3/32), GigabitEthernet0/0 (192.168.34.1/24, to R4).
  - R4 (Area 49.0002, L1-2): Loopback0 (4.4.4.4/32), GigabitEthernet0/0 (192.168.34.2/24, to R3), GigabitEthernet0/1 (192.168.24.2/24, to R2).
- **Goal**: Configure IS-IS for IPv4 routing across two areas, with R2 and R4 as Level 1-2 routers forming the Level 2 backbone, using wide metrics and MD5 authentication.

---

### Step-by-Step Guide to Configure IS-IS for Multi-Area Networks on Cisco Routers

#### 1. **Plan the Multi-Area Topology**
- **Area Assignment**:
  - Assign unique Area IDs to each area (e.g., `49.0001` and `49.0002`).
  - Ensure the Level 2 backbone is contiguous (all Level 2 and Level 1-2 routers must be connected).
- **Router Roles**:
  - R1 and R3: Level 1 routers (intra-area routing within their respective areas).
  - R2 and R4: Level 1-2 routers (intra-area routing in their areas and inter-area routing via the Level 2 backbone).
- **NET Planning**:
  - Each router needs a unique System ID across the entire IS-IS domain.
  - Example NETs:
    - R1: `49.0001.1921.6800.1001.00`
    - R2: `49.0001.1921.6800.2002.00`
    - R3: `49.0002.1921.6800.3003.00`
    - R4: `49.0002.1921.6800.4004.00`

---

#### 2. **Configure Router R1 (Level 1, Area 49.0001)**
- Enable IS-IS, set as Level 1, and configure interfaces.

```bash
hostname R1
!
key chain IS-IS-KEY
 key 1
  key-string MySecurePassword
!
interface Loopback0
 ip address 1.1.1.1 255.255.255.255
 ip router isis
!
interface GigabitEthernet0/0
 ip address 192.168.12.1 255.255.255.0
 ip router isis
 isis metric 10
 isis authentication mode md5
 isis authentication key-chain IS-IS-KEY
!
router isis
 net 49.0001.1921.6800.1001.00
 is-type level-1
 metric-style wide
 authentication mode md5
 authentication key-chain IS-IS-KEY
 passive-interface Loopback0
!
```

- **Explanation**:
  - `is-type level-1`: Restricts R1 to Level 1 routing (intra-area only).
  - `net 49.0001.1921.6800.1001.00`: Assigns NET with Area ID `49.0001`.
  - `ip router isis`: Enables IS-IS on interfaces to advertise IPv4 prefixes.
  - `metric-style wide`: Uses 24-bit metrics for scalability.
  - `authentication`: Secures Hellos (interface) and LSPs (global) with MD5.
  - `passive-interface`: Advertises Loopback0 without forming adjacencies.

---

#### 3. **Configure Router R2 (Level 1-2, Area 49.0001)**
- Enable IS-IS as Level 1-2 to connect Area 49.0001 to the backbone.

```bash
hostname R2
!
key chain IS-IS-KEY
 key 1
  key-string MySecurePassword
!
interface Loopback0
 ip address 2.2.2.2 255.255.255.255
 ip router isis
!
interface GigabitEthernet0/0
 ip address 192.168.12.2 255.255.255.0
 ip router isis
 isis metric 10
 isis authentication mode md5
 isis authentication key-chain IS-IS-KEY
!
interface GigabitEthernet0/1
 ip address 192.168.24.1 255.255.255.0
 ip router isis
 isis metric 10
 isis authentication mode md5
 isis authentication key-chain IS-IS-KEY
!
router isis
 net 49.0001.1921.6800.2002.00
 is-type level-1-2
 metric-style wide
 authentication mode md5
 authentication key-chain IS-IS-KEY
 passive-interface Loopback0
!
```

- **Explanation**:
  - `is-type level-1-2`: Allows R2 to form Level 1 adjacencies in Area 49.0001 (with R1) and Level 2 adjacencies (with R4).
  - `net 49.0001.1921.6800.2002.00`: Uses Area ID `49.0001` for Level 1.
  - Both interfaces participate in IS-IS, with GigabitEthernet0/0 for Level 1 (to R1) and GigabitEthernet0/1 for Level 2 (to R4).

---

#### 4. **Configure Router R3 (Level 1, Area 49.0002)**
- Enable IS-IS as Level 1 for Area 49.0002.

```bash
hostname R3
!
key chain IS-IS-KEY
 key 1
  key-string MySecurePassword
!
interface Loopback0
 ip address 3.3.3.3 255.255.255.255
 ip router isis
!
interface GigabitEthernet0/0
 ip address 192.168.34.1 255.255.255.0
 ip router isis
 isis metric 10
 isis authentication mode md5
 isis authentication key-chain IS-IS-KEY
!
router isis
 net 49.0002.1921.6800.3003.00
 is-type level-1
 metric-style wide
 authentication mode md5
 authentication key-chain IS-IS-KEY
 passive-interface Loopback0
!
```

- **Explanation**:
  - Similar to R1, but in Area `49.0002` with NET `49.0002.1921.6800.3003.00`.
  - Level 1 only, forming adjacency with R4 in the same area.

---

#### 5. **Configure Router R4 (Level 1-2, Area 49.0002)**
- Enable IS-IS as Level 1-2 to connect Area 49.0002 to the backbone.

```bash
hostname R4
!
key chain IS-IS-KEY
irik
 key 1
  key-string MySecurePassword
!
interface Loopback0
 ip address 4.4.4.4 255.255.255.255
 ip router isis
!
interface GigabitEthernet0/0
 ip address 192.168.34.2 255.255.255.0
 ip router isis
 isis metric 10
 isis authentication mode md5
 isis authentication key-chain IS-IS-KEY
!
interface GigabitEthernet0/1
 ip address 192.168.24.2 255.255.255.0
 ip router isis
 isis metric 10
 isis authentication mode md5
 isis authentication key-chain IS-IS-KEY
!
router isis
 net 49.0002.1921.6800.4004.00
 is-type level-1-2
 metric-style wide
 authentication mode md5
 authentication key-chain IS-IS-KEY
 passive-interface Loopback0
!
```

- **Explanation**:
  - Similar to R2, but in Area `49.0002` with NET `49.0002.1921.6800.4004.00`.
  - Forms Level 1 adjacency with R3 and Level 2 adjacency with R2.

---

#### 6. **Configure Route Leaking (Optional)**
- To optimize routing, configure Level 1-2 routers (R2, R4) to leak Level 2 routes into Level 1 areas, allowing R1 and R3 to learn specific inter-area routes instead of relying solely on default routes.

**On R2**:
```bash
R2(config)# router isis
R2(config-router)# redistribute isis ip level-2 into level-1 distribute-list L2-to-L1
R2(config)# ip access-list standard L2-to-L1
R2(config-std-nacl)# permit 3.3.3.3
R2(config-std-nacl)# permit 4.4.4.4
```

**On R4**:
```bash
R4(config)# router isis
R4(config-router)# redistribute isis ip level-2 into level-1 distribute-list L2-to-L1
R4(config)# ip access-list standard L2-to-L1
R4(config-std-nacl)# permit 1.1.1.1
R4(config-std-nacl)# permit 2.2.2.2
```

- **Explanation**:
  - `redistribute isis ip level-2 into level-1`: Leaks Level 2 routes into Level 1 LSDB.
  - `distribute-list L2-to-L1`: Filters which routes to leak (e.g., only R3 and R4’s loopbacks into Area 49.0001, and R1 and R2’s into Area 49.0002).
  - Prevents overwhelming Level 1 routers with unnecessary routes, improving scalability.

---

#### 7. **Verify Configuration**
- Confirm IS-IS operation across areas.

**On R1 (Level 1)**:
```bash
R1# show isis neighbors
R1# show isis database
R1# show ip route isis
R1# show isis topology
```

**On R2 (Level 1-2)**:
```bash
R2# show isis neighbors
R2# show isis database level-1
R2# show isis database level-2
R2# show ip route isis
```

- **Explanation**:
  - `show isis neighbors`: Verifies adjacencies (e.g., R1 sees R2 as Level 1, R2 sees R1 as Level 1 and R4 as Level 2).
  - `show isis database`: Shows Level 1 LSDB (R1, R2 in Area 49.0001) and Level 2 LSDB (R2, R4).
  - `show ip route isis`: Confirms routes (e.g., R1 learns 3.3.3.3/32 and 4.4.4.4/32 via route leaking or default route to R2).
  - `show isis topology`: Displays SPF-calculated paths for Level 1 and Level 2.

---

### Juniper Configuration for Multi-Area IS-IS

Juniper uses a different syntax but follows the same principles. Below is an example for R2 (Level 1-2, Area 49.0001).

```bash
set system host-name R2
set interfaces lo0 unit 0 family inet address 2.2.2.2/32
set interfaces lo0 unit 0 family iso
set interfaces ge-0/0/0 unit 0 family inet address 192.168.12.2/24
set interfaces ge-0/0/0 unit 0 family iso
set interfaces ge-0/0/1 unit 0 family inet address 192.168.24.1/24
set interfaces ge-0/0/1 unit 0 family iso
set protocols isis interface ge-0/0/0.0 level 1 metric 10
set protocols isis interface ge-0/0/1.0 level 2 metric 10
set protocols isis interface lo0.0 passive
set protocols isis level 1 authentication-type md5
set protocols isis level 1 authentication-key MySecurePassword
set protocols isis level 2 authentication-type md5
set protocols isis level 2 authentication-key MySecurePassword
set protocols isis level 1 wide-metrics-only
set protocols isis level 2 wide-metrics-only
set routing-options router-id 2.2.2.2
set routing-options iso net 49.0001.1921.6800.2002.00
set policy-options policy-statement L2-to-L1 term 1 from route-filter 3.3.3.3/32 exact
set policy-options policy-statement L2-to-L1 term 1 from route-filter 4.4.4.4/32 exact
set policy-options policy-statement L2-to-L1 term 1 then accept
set protocols isis export L2-to-L1
```

- **Key Commands**:
  - `family iso`: Enables CLNS for IS-IS control packets.
  - `level 1`/`level 2`: Specifies interface participation in Level 1 (to R1) or Level 2 (to R4).
  - `wide-metrics-only`: Uses 24-bit metrics.
  - `export L2-to-L1`: Leaks Level 2 routes into Level 1 using a policy.
  - Similar configurations apply to R1, R3, and R4, adjusting NETs, interfaces, and levels.

**Verification Commands** (Juniper):
```bash
show isis adjacency
show isis database
show route protocol isis
show isis interface
```

---

### General Best Practices
1. **Contiguous Level 2 Backbone**: Ensure all Level 2 and Level 1-2 routers are connected to form a continuous backbone for inter-area routing.
2. **Unique System IDs**: Use unique System IDs across all areas to avoid LSP conflicts (e.g., `1921.6800.1001` for R1).
3. **Wide Metrics**: Use wide metrics (`metric-style wide` or `wide-metrics-only`) for scalability and consistency.
4. **Route Leaking Control**:
   - Use distribute lists (Cisco) or policies (Juniper) to control route leaking from Level 2 to Level 1.
   - Limit leaked routes to essential prefixes (e.g., loopbacks) to prevent Level 1 LSDB bloat.
5. **Authentication**: Enable MD5 or SHA authentication for both Level 1 and Level 2 to secure Hellos and LSPs.
6. **Area Planning**: Assign Area IDs strategically to minimize the number of Level 1-2 routers and optimize scalability.
7. **Passive Interfaces**: Use passive interfaces for loopbacks to advertise prefixes without adjacencies.
8. **MTU Consistency**: Ensure interface MTUs support large LSPs (e.g., 1492 bytes) to avoid fragmentation.
9. **Convergence Tuning**: Adjust Hello and SPF timers (e.g., `isis hello-interval`, `spf-interval`) for faster convergence.
10. **Monitoring**: Regularly verify adjacencies, LSDB, and routing tables to ensure inter-area connectivity.

---

### Additional Considerations
- **IPv6 Support**: To include IPv6, add `ipv6 router isis` (Cisco) or `family inet6` and `ipv6-unicast` (Juniper) on interfaces, as described in the previous response on IPv4/IPv6 IS-IS.
- **Route Leaking Alternatives**:
  - Without route leaking, Level 1 routers use a default route to the nearest Level 1-2 router (based on the Attached bit in LSPs).
  - Route leaking improves path selection but requires careful filtering to avoid overwhelming Level 1 routers.
- **Scalability**: Minimize the number of Level 1-2 routers to reduce LSDB size and control plane overhead.
- **Vendor Interoperability**: Use standard TLVs (e.g., TLV 135 for IPv4) and consistent metric styles for multi-vendor setups.

---

### Troubleshooting Tips
- **Adjacency Failures**:
  - Level 1: Check matching Area IDs in NETs (e.g., `49.0001` for R1 and R2).
  - Level 2: Ensure Level 2-enabled interfaces between R2 and R4.
  - Verify authentication keys and MTU settings.
- **Missing Routes**:
  - Check LSDB (`show isis database detail`) for missing LSPs or prefixes.
  - Verify route leaking policies or default route installation on Level 1 routers.
- **LSDB Overload**: Limit route leaking and use summarization (e.g., `summary-address` in Cisco) to reduce LSDB size.
- **Backbone Continuity**: Ensure R2 and R4 form a Level 2 adjacency (`show isis neighbors`).

---

### Conclusion
Configuring IS-IS for multi-area networks involves setting up Level 1 routers within each area, Level 1-2 routers at area boundaries, and a contiguous Level 2 backbone for inter-area routing. Each router requires a unique NET, consistent metric style (preferably wide), and secure authentication. Route leaking can optimize routing but must be controlled with filters. Verification ensures proper adjacencies and route propagation across areas, making IS-IS scalable for large networks like service provider backbones or enterprise campuses.

If you need configurations for additional routers, a multi-area topology with IPv6, specific vendor syntax (e.g., Nokia), or detailed troubleshooting steps, let me know!