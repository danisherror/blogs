---
aliases: []
---
Setting up IS-IS for both IPv4 and IPv6 routing involves enabling IS-IS on router interfaces, configuring addressing, and making sure IS-IS supports both protocols simultaneously. IS-IS is inherently protocol-agnostic at the network layer since it runs over CLNS, so IPv4 and IPv6 support is enabled by advertising their prefixes in the IS-IS routing domain.

---

## Steps to Set Up IS-IS for IPv4 and IPv6 Routing

### 1. **Enable IS-IS routing process**

- Configure IS-IS on the router and assign a unique NET (Network Entity Title).
    
- Define the router as Level 1, Level 2, or both.
    

### 2. **Enable IS-IS on interfaces**

- Activate IS-IS on all interfaces participating in the routing domain.
    
- Assign metrics and configure IS-IS parameters per interface.
    

### 3. **Enable IPv4 routing via IS-IS**

- Under the IS-IS process, enable IPv4 address-family support (depends on vendor).
    
- Redistribute IPv4 routes into IS-IS if needed.
    
- Assign IPv4 addresses to interfaces.
    

### 4. **Enable IPv6 routing via IS-IS**

- Enable IPv6 address-family support within IS-IS.
    
- Advertise IPv6 prefixes via IS-IS.
    
- Assign IPv6 addresses on interfaces.
    

### 5. **Configure wide metrics and multi-protocol support**

- Enable IS-IS wide metrics to support routing for both IPv4 and IPv6.
    
- Enable Multi-Topology (MT-ISIS) if you want separate topologies for IPv4 and IPv6.
    

### 6. **Verify adjacency and route propagation**

- Check IS-IS neighbor relationships.
    
- Verify IPv4 and IPv6 routes are learned and propagated.
    

---

## Cisco IOS Example for IPv4 + IPv6 IS-IS

```bash
! Step 1: Enable IS-IS and set NET
router isis 1
 net 49.0001.1921.6800.1001.00
 is-type level-2-only
 metric-style wide

! Step 2: Enable IS-IS on interfaces
interface GigabitEthernet0/1
 ip address 10.1.1.1 255.255.255.0
 ipv6 address 2001:db8::1/64
 ip router isis 1
 ipv6 router isis 1
 isis network point-to-point

! Step 3: Enable IPv6 routing protocol globally
ipv6 unicast-routing

! Step 4: Verify neighbors and routes
show clns neighbors
show isis database
show ipv6 route isis
show ip route isis
```

---

## Juniper Junos Example for IPv4 + IPv6 IS-IS

```bash
set routing-options router-id 1.1.1.1
set protocols isis level 2 wide-metrics-only
set protocols isis interface ge-0/0/0.0
set protocols isis interface ge-0/0/0.0 level 2
set protocols isis interface ge-0/0/0.0 metric 10
set protocols isis interface ge-0/0/0.0 hello-interval 10

set interfaces ge-0/0/0 unit 0 family inet address 10.1.1.1/24
set interfaces ge-0/0/0 unit 0 family inet6 address 2001:db8::1/64

set protocols isis interface ge-0/0/0.0 family inet level 2
set protocols isis interface ge-0/0/0.0 family inet6 level 2
```

---

## Important Notes

- IS-IS does not rely on IP to carry its packets, so it supports IPv4 and IPv6 routing without separate routing protocols.
    
- Wide metrics are recommended for IPv6 since narrow metrics are limited to 6 bits and can't support modern link speeds well.
    
- Multi-topology IS-IS (MT-ISIS) can be used for maintaining separate IPv4 and IPv6 topologies.
    
- Always enable IPv6 unicast routing on Cisco devices when using IS-IS for IPv6.
    

---

If you want, I can provide more detailed configuration for specific vendors or cover MT-ISIS and Traffic Engineering for IPv6. Would that help?

---
---
---
---
Setting up IS-IS (Intermediate System to Intermediate System) for both **IPv4** and **IPv6** routing involves configuring the protocol to support multiple address families within a single IS-IS instance, leveraging its protocol-independent design and Type-Length-Value (TLV) extensibility. The steps are similar to configuring IS-IS for IPv4 alone but include additional commands to enable IPv6 address family support and advertise IPv6 prefixes. Below is a step-by-step guide for configuring IS-IS for IPv4 and IPv6 routing on a **Cisco router**, as it’s a widely used platform, followed by notes for **Juniper** and general best practices. If you need configurations for another vendor (e.g., Nokia) or a specific scenario, let me know!

---

### Scenario Assumptions
- **Router R1** in Area `49.0001` with System ID `1921.6800.1001`.
- **Interfaces**:
  - GigabitEthernet0/0: IPv4 (192.168.12.1/24), IPv6 (2001:db8:12::1/64).
  - Loopback0: IPv4 (1.1.1.1/32), IPv6 (2001:db8:1::1/128).
- **Goal**: Enable IS-IS for both IPv4 and IPv6 routing, configure as a Level 1-2 router (default), use wide metrics, and secure with MD5 authentication.

---

### Step-by-Step Guide to Configure IS-IS for IPv4 and IPv6 on a Cisco Router

#### 1. **Enable IS-IS Globally**
- Start the IS-IS process and assign a Network Entity Title (NET).

```bash
R1# configure terminal
R1(config)# router isis
R1(config-router)# net 49.0001.1921.6800.1001.00
```

- **Explanation**:
  - `router isis`: Enables the IS-IS process (no process ID needed).
  - `net 49.0001.1921.6800.1001.00`: Configures the NET:
    - `49`: Authority and Format Identifier (AFI).
    - `0001`: Area ID (Area 49.0001).
    - `1921.6800.1001`: System ID (unique across the IS-IS domain).
    - `00`: Selector (always 00).
  - The NET is used for both IPv4 and IPv6 routing, as IS-IS operates over CLNS.

---

#### 2. **Specify IS-IS Router Type (Optional)**
- Set the router type (default is Level 1-2).

```bash
R1(config-router)# is-type level-1-2
```

- **Explanation**:
  - `is-type level-1-2`: Configures the router to operate as both Level 1 (intra-area) and Level 2 (inter-area).
  - Alternatives: `level-1` (intra-area only) or `level-2-only` (backbone only).
  - Level 1-2 is suitable for most deployments, allowing flexibility.

---

#### 3. **Enable Wide Metrics**
- Configure wide metrics to support large-scale networks and Traffic Engineering (TE).

```bash
R1(config-router)# metric-style wide
```

- **Explanation**:
  - `metric-style wide`: Enables 24-bit metrics (TLV 22/135), supporting values up to 16,777,215 for both IPv4 and IPv6.
  - Wide metrics are essential for IPv6 and modern features like Segment Routing.
  - Alternative: `metric-style transition` for compatibility with legacy narrow metric routers.

---

#### 4. **Configure Interfaces for IPv4 and IPv6**
- Enable IS-IS on interfaces and assign IPv4 and IPv6 addresses.

```bash
R1(config)# interface GigabitEthernet0/0
R1(config-if)# ip address 192.168.12.1 255.255.255.0
R1(config-if)# ipv6 address 2001:db8:12::1/64
R1(config-if)# ip router isis
R1(config-if)# ipv6 router isis
R1(config-if)# isis metric 20
R1(config-if)# exit
R1(config)# interface Loopback0
R1(config-if)# ip address 1.1.1.1 255.255.255.255
R1(config-if)# ipv6 address 2001:db8:1::1/128
R1(config-if)# ip router isis
R1(config-if)# ipv6 router isis
```

- **Explanation**:
  - `ip address` and `ipv6 address`: Assign IPv4 and IPv6 addresses to the interface.
  - `ip router isis`: Enables IS-IS for IPv4, advertising the IPv4 subnet.
  - `ipv6 router isis`: Enables IS-IS for IPv6, advertising the IPv6 prefix.
  - `isis metric 20`: Sets the metric for the interface (applies to both IPv4 and IPv6 unless specified otherwise).
  - Loopback0 is included to advertise stable router IDs for both address families.

---

#### 5. **Enable IPv4 and IPv6 Address Families**
- Ensure IS-IS supports both IPv4 and IPv6 address families globally (often implicit in modern Cisco IOS).

```bash
R1(config)# router isis
R1(config-router)# address-family ipv4 unicast
R1(config-router-af)# metric-style wide
R1(config-router-af)# exit
R1(config-router)# address-family ipv6 unicast
R1(config-router-af)# metric-style wide
```

- **Explanation**:
  - `address-family ipv4 unicast`: Configures IPv4 routing (often enabled by default).
  - `address-family ipv6 unicast`: Explicitly enables IPv6 routing.
  - `metric-style wide`: Ensures wide metrics for both address families.
  - In modern Cisco IOS (e.g., IOS-XE), enabling `ipv6 router isis` on interfaces may automatically activate the IPv6 address family, but explicit configuration ensures clarity.

---

#### 6. **Configure Authentication (Optional, Recommended)**
- Secure IS-IS adjacencies and LSPs for both IPv4 and IPv6.

```bash
R1(config)# key chain IS-IS-KEY
R1(config-keychain)# key 1
R1(config-keychain-key)# key-string MySecurePassword
R1(config)# router isis
R1(config-router)# authentication mode md5
R1(config-router)# authentication key-chain IS-IS-KEY
R1(config)# interface GigabitEthernet0/0
R1(config-if)# isis authentication mode md5
R1(config-if)# isis authentication key-chain IS-IS-KEY
```

- **Explanation**:
  - `authentication mode md5`: Enables MD5 authentication globally (for LSPs) and per interface (for Hellos).
  - `authentication key-chain`: Specifies the key chain for authentication.
  - Authentication applies to both IPv4 and IPv6, as IS-IS uses a single control plane.
  - Alternatives: SHA authentication (if supported) or cleartext (less secure).

---

#### 7. **Advertise Passive Interfaces (Optional)**
- Include interfaces like Loopback0 in IS-IS advertisements without forming adjacencies.

```bash
R1(config)# router isis
R1(config-router)# passive-interface Loopback0
```

- **Explanation**:
  - `passive-interface`: Advertises the interface’s IPv4 and IPv6 prefixes in LSPs but prevents sending/receiving IS-IS packets.
  - Reduces overhead for interfaces not forming adjacencies.

---

#### 8. **Verify Configuration**
- Confirm IS-IS operation for both IPv4 and IPv6.

```bash
R1# show isis neighbors
R1# show isis database
R1# show ip route isis
R1# show ipv6 route isis
R1# show isis topology
R1# show clns interface
```

- **Explanation**:
  - `show isis neighbors`: Verifies adjacencies, including Level 1/2 and System IDs.
  - `show isis database`: Displays the LSDB, including IPv4 (TLV 128/135) and IPv6 (TLV 236) prefixes.
  - `show ip route isis`: Lists IPv4 routes learned via IS-IS.
  - `show ipv6 route isis`: Lists IPv6 routes learned via IS-IS.
  - `show isis topology`: Shows the SPF-calculated topology for both address families.
  - `show clns interface`: Confirms IS-IS is enabled on interfaces for CLNS.

---

### Example Complete Configuration (Cisco)

```bash
hostname R1
!
key chain IS-IS-KEY
 key 1
  key-string MySecurePassword
!
interface Loopback0
 ip address 1.1.1.1 255.255.255.255
 ipv6 address 2001:db8:1::1/128
 ip router isis
 ipv6 router isis
!
interface GigabitEthernet0/0
 ip address 192.168.12.1 255.255.255.0
 ipv6 address 2001:db8:12::1/64
 ip router isis
 ipv6 router isis
 isis metric 20
 isis authentication mode md5
 isis authentication key-chain IS-IS-KEY
!
router isis
 net 49.0001.1921.6800.1001.00
 is-type level-1-2
 metric-style wide
 authentication mode md5
 authentication key-chain IS-IS-KEY
 passive-interface Loopback0
 address-family ipv4 unicast
  metric-style wide
 address-family ipv6 unicast
  metric-style wide
!
```

---

### Juniper Configuration for IPv4 and IPv6

Juniper uses a different syntax but follows the same principles. IS-IS for IPv4 and IPv6 is configured under a single protocol instance, with address families enabled on interfaces.

**Example Juniper Configuration**:
```bash
set system host-name R1
set interfaces lo0 unit 0 family inet address 1.1.1.1/32
set interfaces lo0 unit 0 family inet6 address 2001:db8:1::1/128
set interfaces lo0 unit 0 family iso
set interfaces ge-0/0/0 unit 0 family inet address 192.168.12.1/24
set interfaces ge-0/0/0 unit 0 family inet6 address 2001:db8:12::1/64
set interfaces ge-0/0/0 unit 0 family iso
set protocols isis interface ge-0/0/0.0 level 1 metric 20
set protocols isis interface ge-0/0/0.0 ipv6-unicast
set protocols isis interface lo0.0 passive
set protocols isis level 1 authentication-type md5
set protocols isis level 1 authentication-key MySecurePassword
set protocols isis level 2 authentication-type md5
set protocols isis level 2 authentication-key MySecurePassword
set protocols isis level 1 wide-metrics-only
set protocols isis level 2 wide-metrics-only
set routing-options router-id 1.1.1.1
set routing-options iso net 49.0001.1921.6800.1001.00
```

- **Key Commands**:
  - `family iso`: Enables CLNS on interfaces for IS-IS control packets.
  - `family inet` and `family inet6`: Enable IPv4 and IPv6 address families.
  - `ipv6-unicast`: Explicitly enables IPv6 routing on the interface.
  - `wide-metrics-only`: Uses wide metrics for both IPv4 and IPv6.
  - `authentication-type md5`: Secures adjacencies and LSPs.

**Verification Commands** (Juniper):
```bash
show isis adjacency
show isis database
show route protocol isis
show isis interface
```

---

### General Best Practices
1. **Unique NETs**: Ensure the System ID is unique across the IS-IS domain to avoid LSP conflicts.
2. **Wide Metrics**: Always use wide metrics (`metric-style wide` or `wide-metrics-only`) for IPv6 and scalability.
3. **Single Topology vs. Multi-Topology**:
   - By default, IS-IS uses a **single topology** for IPv4 and IPv6, assuming the same routing paths. This is simpler and common.
   - For **multi-topology IS-IS (MT-ISIS)** (separate topologies for IPv4/IPv6), enable with `multi-topology` (Cisco) or `topology ipv6-unicast` (Juniper), but ensure network design supports it.
4. **Authentication**: Enable MD5 or SHA authentication to secure control packets.
5. **Passive Interfaces**: Use passive interfaces for loopbacks to advertise prefixes without adjacencies.
6. **Consistent Configuration**: Ensure all routers in the domain support IPv6 and use consistent metric styles and levels.
7. **MTU Considerations**: Verify interface MTUs support large IS-IS packets (e.g., 1492 bytes for LSPs) to prevent fragmentation issues.
8. **Convergence Tuning**: Adjust Hello and SPF timers (e.g., `isis hello-interval`, `spf-interval`) for faster convergence in large networks.
9. **Monitoring**: Regularly check adjacencies, LSDB, and routing tables for both IPv4 and IPv6.

---

### Additional Considerations
- **Single vs. Multi-Topology**:
  - Single topology is default and simpler, using the same SPF tree for IPv4 and IPv6. Ensure IPv4 and IPv6 are configured on the same interfaces to avoid blackholing.
  - Multi-topology (RFC 5120) allows separate SPF calculations for IPv4 and IPv6, useful if topologies differ (e.g., IPv6 on some links only). Example Cisco command:
    ```bash
    R1(config-router)# address-family ipv6 unicast
    R1(config-router-af)# multi-topology
    ```
- **IPv6 Transition**: Ensure all routers support IPv6 IS-IS (TLV 236) and have consistent configurations to avoid partial routing.
- **Traffic Engineering**: For TE or Segment Routing, enable TE extensions (e.g., `traffic-engineering` in Juniper) and use wide metrics.
- **Vendor Interoperability**: Use standard TLVs (e.g., TLV 135 for IPv4, TLV 236 for IPv6) for multi-vendor setups.

---

### Troubleshooting Tips
- **Adjacency Failures**: Check NET Area IDs (Level 1), authentication mismatches, or missing `family iso` (Juniper) on interfaces.
- **Missing IPv6 Routes**: Verify `ipv6 router isis` (Cisco) or `ipv6-unicast` (Juniper) is enabled on interfaces and that TLV 236 is present in LSPs (`show isis database detail`).
- **Inconsistent Topologies**: Ensure IPv4 and IPv6 are configured on the same interfaces for single-topology mode, or enable multi-topology if needed.
- **LSP Issues**: Check MTU mismatches or LSDB overload (`show isis database`).

---

### Conclusion
Configuring IS-IS for IPv4 and IPv6 routing involves enabling the protocol with a NET, activating interfaces for both address families, using wide metrics, and securing with authentication. Cisco requires `ip router isis` and `ipv6 router isis` per interface, while Juniper uses `family inet`, `family inet6`, and `ipv6-unicast`. The single-topology mode simplifies deployment, but multi-topology is available for complex scenarios. Verification ensures proper adjacencies and routing for both protocols, making IS-IS ideal for dual-stack networks in service providers or data centers.

If you need a specific configuration (e.g., multi-topology, another vendor, or a multi-area setup), sample outputs for verification, or further troubleshooting guidance, let me know!