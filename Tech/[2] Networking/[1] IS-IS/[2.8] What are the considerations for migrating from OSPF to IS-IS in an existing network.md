Migrating from OSPF to IS-IS in an existing network is a significant architectural change and requires careful planning to minimize disruption. Here are the key considerations you should keep in mind:

---

### 1. **Network Design & Compatibility**

- **Understand Current Topology**  
    Assess the existing OSPF design: areas, types of areas (backbone, stub, NSSA), and adjacency relationships.
    
- **IS-IS Hierarchy Differences**  
    IS-IS uses Level 1 (intra-area) and Level 2 (inter-area) routers instead of OSPF’s Area 0 backbone and regular areas. Plan how OSPF areas will map to IS-IS levels.
    
- **Addressing Scheme**  
    IS-IS originally used CLNS addresses (NETs), but modern IS-IS supports IPv4/IPv6 directly. Confirm your IP addressing plan is compatible.
    

---

### 2. **Routing Protocol Differences**

- **Protocol Fundamentals**  
    OSPF uses IP protocol number 89, while IS-IS runs directly over Layer 2 (Ethernet, not IP). Ensure your network equipment and links support IS-IS Layer 2 encapsulation.
    
- **Metric Calculation**  
    OSPF uses cost (based on bandwidth), IS-IS uses metrics that can be narrow (16-bit) or wide (24-bit). Metrics may need recalculation or adjustment.
    
- **Authentication Differences**  
    OSPF and IS-IS support different authentication mechanisms. Plan for configuration changes and key management.
    

---

### 3. **Equipment and Vendor Support**

- **Device Compatibility**  
    Confirm all routers and switches support IS-IS, including features you require (IPv6, multi-area, authentication).
    
- **Software Versions**  
    Some older devices or OS versions may have limited IS-IS functionality or bugs; plan upgrades if needed.
    

---

### 4. **Operational Impact and Transition Strategy**

- **Dual-Protocol Operation**  
    Consider running OSPF and IS-IS simultaneously during migration (dual routing protocols) to minimize downtime.
    
- **Route Redistribution**  
    Plan and configure careful route redistribution between OSPF and IS-IS during transition to avoid loops or route flapping.
    
- **Test in Lab/Segment**  
    Validate IS-IS configuration and behavior in a lab or limited production segment before full rollout.
    

---

### 5. **Training and Operational Readiness**

- **Staff Familiarity**  
    Train network operations team on IS-IS concepts, troubleshooting, and tools.
    
- **Monitoring and Management**  
    Update network monitoring systems, SNMP, and management tools for IS-IS.
    

---

### 6. **Configuration and Naming Conventions**

- **NET and System ID Assignment**  
    Establish naming conventions for IS-IS NETs and System IDs consistent with network design.
    
- **Area Design**  
    Map OSPF area design to IS-IS Level 1 and Level 2 areas logically.
    

---

### 7. **Performance and Scalability Considerations**

- **Evaluate IS-IS Benefits**  
    Confirm IS-IS is chosen for its scalability, simplicity in multi-area design, or better handling of large networks.
    
- **Plan for Metrics and SPF Timers**  
    Tune IS-IS SPF and LSP parameters to optimize convergence and CPU usage.
    

---

### 8. **Backup and Rollback Plans**

- **Maintain Backup Configurations**  
    Keep OSPF configs intact for rollback if issues arise.
    
- **Rollback Procedures**  
    Have clear procedures to revert to OSPF quickly in case of unexpected problems.
    

---

### 9. **Documentation**

- Update network diagrams, routing protocol documentation, and operational runbooks to reflect IS-IS deployment.
    

---

### Summary Checklist for OSPF to IS-IS Migration

|Consideration|Description|
|---|---|
|Topology Mapping|OSPF areas → IS-IS Levels|
|Addressing & Protocol Support|Verify IS-IS support and Layer 2 encapsulation|
|Metric & Authentication|Plan metric recalculation and auth configuration|
|Dual Protocol Operation|Run OSPF and IS-IS simultaneously during migration|
|Redistribution Strategy|Prevent routing loops with careful route redistribution|
|Staff Training|Prepare team for IS-IS operational differences|
|Equipment Compatibility|Confirm device & software readiness|
|Monitoring & Management|Update tools to support IS-IS|
|Backup & Rollback|Maintain OSPF configs for fallback|
|Documentation|Keep records updated|

---

Would you like a detailed migration plan template or example commands for migrating Cisco routers from OSPF to IS-IS?

---
---
---
---
Migrating from **OSPF (Open Shortest Path First)** to **IS-IS (Intermediate System to Intermediate System)** in an existing network is a complex process that requires careful planning to minimize disruption, ensure compatibility, and maintain network stability. Both protocols are link-state interior gateway protocols (IGPs), but they differ in design, operation, and features, necessitating a strategic approach to the transition. Below are the **key considerations** for migrating from OSPF to IS-IS, organized into planning, design, implementation, and post-migration phases, with practical examples and best practices. The focus is on a typical enterprise or service provider network running IPv4, with notes on IPv6 and multi-vendor environments.

---

### Key Differences Between OSPF and IS-IS
Understanding the differences between OSPF and IS-IS is critical for planning the migration:
- **Protocol Dependency**:
  - OSPF: Runs over IP (uses IP packets, relies on IP addressing).
  - IS-IS: Runs over CLNS (Connectionless Network Service), independent of IP, using NETs for identification.
- **Addressing**:
  - OSPF: Uses router IDs (typically IP addresses) and area numbers (e.g., 0.0.0.1).
  - IS-IS: Uses NETs (e.g., `49.0001.1921.6800.1001.00`) with Area IDs and System IDs.
- **Hierarchy**:
  - OSPF: Multiple areas connected to Area 0 (backbone).
  - IS-IS: Level 1 areas connected via a Level 2 backbone.
- **Packet Types**:
  - OSPF: Hello, LSA (Link State Advertisement), LSR, LSU, LSAck.
  - IS-IS: Hello (IIH), LSP (Link State Packet), CSNP, PSNP.
- **Extensibility**:
  - IS-IS: More extensible via TLVs (Type-Length-Value), supports IPv4, IPv6, and other protocols in a single instance.
  - OSPF: Separate instances for IPv4 (OSPFv2) and IPv6 (OSPFv3).
- **Metrics**:
  - OSPF: Default metric based on interface bandwidth (cost = reference bandwidth / interface bandwidth).
  - IS-IS: Default metric is 10 per interface (Cisco), supports narrow (6-bit) or wide (24-bit) metrics.
- **Adjacency Formation**:
  - OSPF: Requires matching area, network type, and authentication.
  - IS-IS: Requires matching Area ID for Level 1, no Area ID match needed for Level 2.

---

### Considerations for Migrating from OSPF to IS-IS

#### 1. **Planning Phase**
- **Assess Current OSPF Network**:
  - Document the OSPF topology: areas, router roles (ABR, ASBR), interfaces, metrics, authentication, and timers.
  - Example: Map Area 0 (backbone), Area 1, Area 2, etc., with router IDs and adjacencies (`show ip ospf neighbor`, `show ip ospf database`).
  - Identify OSPF features in use (e.g., stub areas, NSSA, summarization, virtual links) and their IS-IS equivalents.
  - Check for external route redistribution (e.g., BGP, static) and how it’s handled in OSPF.
- **Define Migration Goals**:
  - Why migrate? Common reasons include:
    - Better scalability (IS-IS TLVs, single instance for IPv4/IPv6).
    - Multi-vendor support (IS-IS is vendor-neutral, widely implemented).
    - Traffic Engineering (IS-IS supports MPLS TE, Segment Routing).
    - Future-proofing for IPv6 or multi-protocol environments.
  - Determine if a full replacement or coexistence (dual-stack IGP) is needed.
- **Inventory Hardware and Software**:
  - Verify all routers support IS-IS (most modern Cisco, Juniper, Nokia routers do).
  - Check software versions for IS-IS features (e.g., wide metrics, IPv6, TE).
  - Example: Cisco IOS 15.x or Juniper Junos 20.x support IS-IS with wide metrics and IPv6.
- **Plan Downtime and Rollback**:
  - Assess potential downtime during migration (minimal with proper staging).
  - Develop a rollback plan to revert to OSPF if issues arise (e.g., keep OSPF configurations commented out).
- **Map OSPF Areas to IS-IS Areas**:
  - OSPF Area 0 → IS-IS Level 2 backbone.
  - OSPF non-backbone areas (e.g., Area 1, Area 2) → IS-IS Level 1 areas (e.g., `49.0001`, `49.0002`).
  - Example: OSPF Area 0.0.0.1 becomes IS-IS Area `49.0001`, with ABRs mapped to Level 1-2 routers.
- **Design NETs for IS-IS**:
  - Assign unique System IDs (6 bytes, e.g., `1921.6800.1001` from loopback IP 192.168.1.1).
  - Use concise Area IDs (e.g., `49.0001`) for scalability.
  - Example: Router R1 in OSPF Area 1 → NET `49.0001.1921.6800.1001.00`.
- **Stakeholder Communication**:
  - Notify teams (network operations, application owners) of migration schedules and potential impacts.
  - Schedule migration during maintenance windows to minimize disruption.

#### 2. **Design Phase**
- **Choose Migration Strategy**:
  - **Overlay Approach**: Run IS-IS alongside OSPF (dual IGP) temporarily, then phase out OSPF.
    - Pros: Minimal disruption, allows gradual transition.
    - Cons: Increased control plane overhead, complex redistribution.
  - **Cutover Approach**: Replace OSPF with IS-IS in a single maintenance window.
    - Pros: Cleaner, avoids long-term dual IGP complexity.
    - Cons: Riskier, requires precise execution.
  - **Hybrid Approach**: Migrate specific areas or segments incrementally, using redistribution at boundaries.
    - Recommended for large networks with multiple areas.
- **Align Metrics**:
  - Map OSPF costs to IS-IS metrics to maintain consistent path selection.
  - OSPF cost = reference bandwidth (default 100 Mbps) / interface bandwidth.
  - IS-IS default metric = 10 (Cisco), or use wide metrics (0–16,777,215) for better granularity.
  - Example: OSPF cost of 10 for a 10 Gbps link → IS-IS wide metric of 10.
  - Use wide metrics (`metric-style wide` in Cisco) for scalability and TE support.
- **Plan Authentication**:
  - OSPF typically uses MD5 or cleartext authentication.
  - IS-IS supports MD5, SHA, or cleartext for Hellos and LSPs.
  - Recommendation: Use MD5 authentication with key chains for IS-IS, aligning with OSPF security.
  - Example: Transition OSPF MD5 keys to IS-IS key chains during migration.
- **Handle Route Redistribution**:
  - If running dual IGPs, redistribute routes between OSPF and IS-IS at Level 1-2 routers or ABRs.
  - Use route-maps or policies to control redistribution and prevent loops.
  - Example: Redistribute OSPF into IS-IS with a higher metric to prefer IS-IS routes once stable.
- **Support IPv4 and IPv6**:
  - If the network runs OSPFv2 (IPv4) and OSPFv3 (IPv6), IS-IS can consolidate both into a single instance using TLVs (135 for IPv4, 236 for IPv6).
  - Plan for dual-stack interfaces during migration.
- **Consider Multi-Vendor Interoperability**:
  - Ensure IS-IS configurations use standard TLVs (e.g., TLV 22 for wide metrics) for Cisco, Juniper, Nokia, etc.
  - Test interoperability in a lab (e.g., Cisco-to-Juniper adjacencies).
- **Plan for Summarization and Route Leaking**:
  - OSPF summarization at ABRs → IS-IS summarization at Level 1-2 routers.
  - OSPF stub/NSSA areas → IS-IS Level 1 areas with route leaking for external routes.
  - Example: Summarize 192.168.0.0/16 at a Level 1-2 router to reduce Level 2 LSDB size.

#### 3. **Implementation Phase**
- **Test in a Lab**:
  - Build a lab replicating the production topology (physical or virtual, e.g., GNS3, EVE-NG).
  - Test IS-IS configurations, adjacencies, and redistribution with OSPF.
  - Simulate failures (e.g., link down, router reload) to validate convergence.
- **Enable IS-IS Alongside OSPF (Overlay Approach)**:
  - Configure IS-IS on all routers without removing OSPF.
  - Example (Cisco for Router R1):
    ```bash
    router isis
     net 49.0001.1921.6800.1001.00
     metric-style wide
     is-type level-1-2
    interface GigabitEthernet0/0
     ip address 192.168.12.1 255.255.255.0
     ip router isis
     isis metric 10
    ```
  - Example (Juniper):
    ```bash
    set interfaces ge-0/0/0 unit 0 family inet address 192.168.12.1/24
    set interfaces ge-0/0/0 unit 0 family iso
    set protocols isis interface ge-0/0/0.0 level 1 metric 10
    set protocols isis interface ge-0/0/0.0 level 2 metric 10
    set routing-options iso net 49.0001.1921.6800.1001.00
    ```
  - Keep OSPF running (`router ospf` or `protocols ospf`).
- **Adjust Protocol Preference**:
  - Set IS-IS administrative distance (AD) or preference higher than OSPF to prefer OSPF routes initially.
  - Cisco: OSPF AD = 110, IS-IS AD = 115 (default).
  - Juniper: OSPF preference = 10 (internal), 150 (external); IS-IS preference = 15 (Level 1), 18 (Level 2).
  - Example (Cisco, lower IS-IS AD to prefer IS-IS later):
    ```bash
    router isis
     distance 100
    ```
  - Example (Juniper, lower IS-IS preference):
    ```bash
    set protocols isis level 1 preference 5
    set protocols isis level 2 preference 5
    ```
- **Redistribute Routes (If Needed)**:
  - Configure mutual redistribution at boundary routers (e.g., Level 1-2 or ABRs) with route-maps to avoid loops.
  - Example (Cisco, redistribute OSPF into IS-IS):
    ```bash
    router isis
     redistribute ospf 1 metric 100 route-map OSPF-to-ISIS
    ip access-list standard OSPF-ROUTES
     permit 192.168.0.0 0.0.255.255
    route-map OSPF-to-ISIS permit 10
     match ip address OSPF-ROUTES
    ```
  - Example (Juniper):
    ```bash
    set policy-options policy-statement OSPF-to-ISIS term 1 from protocol ospf
    set policy-options policy-statement OSPF-to-ISIS term 1 from route-filter 192.168.0.0/16 orlonger
    set policy-options policy-statement OSPF-to-ISIS term 1 then metric 100
    set policy-options policy-statement OSPF-to-ISIS term 1 then accept
    set protocols isis export OSPF-to-ISIS
    ```
- **Verify IS-IS Operation**:
  - Check adjacencies: `show isis neighbors` (Cisco), `show isis adjacency` (Juniper).
  - Verify LSDB: `show isis database` (Cisco), `show isis database` (Juniper).
  - Confirm routes: `show ip route isis` (Cisco), `show route protocol isis` (Juniper).
- **Phase Out OSPF Gradually**:
  - Once IS-IS is stable, increase IS-IS preference (lower AD or preference).
  - Remove OSPF from interfaces (`no ip ospf 1` in Cisco, `delete protocols ospf` in Juniper) and routers in stages (e.g., per area).
  - Monitor for routing disruptions during each phase.

#### 4. **Post-Migration Phase**
- **Validate Network Operation**:
  - Confirm all routes are present and paths align with OSPF (`show ip route isis`).
  - Test application connectivity and failover scenarios.
  - Verify IS-IS convergence times (`show isis spf-log` in Cisco).
- **Optimize IS-IS Configuration**:
  - Tune timers (e.g., `isis hello-interval 3`) for faster convergence.
  - Enable features like iSPF (`ispf level-1-2`) or BFD for link failure detection.
  - Implement summarization at Level 1-2 routers (`summary-address` in Cisco).
- **Clean Up Configurations**:
  - Remove OSPF configurations and redistribution policies.
  - Delete temporary route-maps or access-lists used during migration.
- **Update Documentation**:
  - Document IS-IS NETs, areas, metrics, and authentication settings.
  - Update network diagrams to reflect IS-IS topology.
- **Train Staff**:
  - Provide training on IS-IS operation, troubleshooting, and differences from OSPF (e.g., NETs vs. router IDs, TLVs vs. LSAs).
- **Monitor Long-Term**:
  - Use SNMP or telemetry to monitor IS-IS adjacency stability and LSDB size.
  - Watch for issues like LSP flooding storms or overload conditions (`show isis statistics`).

---

### Specific Considerations
- **Convergence Time**:
  - IS-IS can converge faster than OSPF with proper tuning (e.g., iSPF, BFD), but initial migration may introduce temporary delays due to dual IGPs.
  - Test convergence in the lab to set expectations.
- **MTU Issues**:
  - IS-IS requires interfaces to support large packets (e.g., 1492 bytes for LSPs). Ensure MTUs match across links to avoid adjacency or LSP flooding issues.
  - Example: `mtu 1500` on Ethernet interfaces.
- **Multi-Area Design**:
  - Map OSPF areas to IS-IS Level 1 areas, ensuring a contiguous Level 2 backbone (similar to OSPF Area 0).
  - Use route leaking (`redistribute isis ip level-2 into level-1` in Cisco) to mimic OSPF’s behavior for non-backbone areas.
- **IPv6 Migration**:
  - If running OSPFv3 for IPv6, consolidate into IS-IS with `ipv6 router isis` (Cisco) or `family inet6` (Juniper).
  - Example: Single IS-IS instance for both IPv4 and IPv6 reduces complexity compared to OSPFv2/OSPFv3.
- **Traffic Engineering**:
  - If migrating to leverage IS-IS TE (e.g., MPLS, Segment Routing), enable TE extensions post-migration (`traffic-engineering` in Juniper).
  - Requires wide metrics (`metric-style wide`).
- **Vendor-Specific Behaviors**:
  - Cisco: Default metric is 10 per interface; Juniper uses bandwidth-based metrics by default.
  - Align metric strategies during migration (e.g., use wide metrics everywhere).
  - Test vendor interoperability for TLV support (e.g., TLV 22 for wide metrics).
- **External Route Handling**:
  - OSPF external routes (E1/E2) map to IS-IS external routes in Level 2.
  - Use redistribution policies to maintain external route preferences.
- **Virtual Links**:
  - OSPF virtual links have no direct IS-IS equivalent. Redesign the topology to ensure a contiguous Level 2 backbone.
- **Scalability**:
  - IS-IS supports larger LSDBs due to TLV extensibility, but limit Level 1 area size (e.g., 100–200 routers) to manage control plane load.
  - Use summarization and route leaking to optimize LSDB size.

---

### Example Migration Workflow (Overlay Approach)
1. **Pre-Migration**:
   - Document OSPF topology: Area 0 (R1, R2), Area 1 (R3, R4).
   - Plan IS-IS: Area `49.0001` (R3, R4 as Level 1), Level 2 (R1, R2).
   - Assign NETs: R1 (`49.0001.1921.6800.1001.00`), R2 (`49.0001.1921.6800.2002.00`), etc.
2. **Enable IS-IS**:
   - Configure IS-IS on all routers, keeping OSPF active.
   - Set IS-IS AD higher (e.g., 120 in Cisco) to prefer OSPF routes.
   - Verify IS-IS adjacencies and LSDB.
3. **Redistribute Routes**:
   - Redistribute OSPF into IS-IS at Level 1-2 routers (R1, R2) with route-maps.
   - Monitor routing tables for consistency.
4. **Transition Preference**:
   - Lower IS-IS AD to 100 to prefer IS-IS routes.
   - Verify traffic paths align with IS-IS.
5. **Remove OSPF**:
   - Disable OSPF on interfaces in Area 1, then Area 0.
   - Remove OSPF process (`no router ospf 1`).
6. **Post-Migration**:
   - Optimize IS-IS timers, enable TE if needed.
   - Update documentation and train staff.

---

### Best Practices
1. **Lab Testing**: Simulate the migration in a lab to validate configurations and failover scenarios.
2. **Incremental Migration**: Start with non-critical areas or segments to gain confidence.
3. **Redundancy**: Ensure redundant paths exist to handle temporary routing inconsistencies.
4. **Monitoring**: Use tools like `debug isis adj-packets` (Cisco) or `traceoptions` (Juniper) to track adjacency issues.
5. **Rollback Plan**: Keep OSPF configurations backed up and ready to restore if needed.
6. **Documentation**: Update network diagrams, IPAM, and runbooks to reflect IS-IS.
7. **Vendor Alignment**: Standardize TLVs, metrics, and authentication across Cisco, Juniper, etc.

---

### Troubleshooting Tips
- **Adjacency Failures**:
  - Check IS-IS Area IDs for Level 1 (`show isis neighbors`).
  - Verify authentication keys and MTU settings.
- **Route Inconsistencies**:
  - Inspect LSDB (`show isis database detail`) for missing prefixes.
  - Check redistribution policies for loops or missing routes.
- **Convergence Delays**:
  - Tune IS-IS timers (`isis hello-interval`) and enable iSPF or BFD.
  - Monitor SPF runs (`show isis spf-log`).
- **Multi-Vendor Issues**:
  - Ensure TLV compatibility (e.g., TLV 22 for wide metrics).
  - Test interoperability in a lab before production.

---

### Conclusion
Migrating from OSPF to IS-IS requires thorough planning, including assessing the current OSPF topology, mapping areas to IS-IS levels, and designing NETs. The overlay approach (running both protocols temporarily) minimizes disruption, with careful redistribution and preference tuning ensuring a smooth transition. Key considerations include aligning metrics, handling authentication, supporting IPv4/IPv6, and ensuring multi-vendor compatibility. Testing in a lab, monitoring during migration, and maintaining a rollback plan are critical for success. Post-migration optimization (e.g., timers, TE) and updated documentation ensure a scalable, stable IS-IS network.

If you need a detailed migration plan for a specific topology, configurations for other vendors (e.g., Nokia), IPv6 considerations, or troubleshooting guidance, let me know!